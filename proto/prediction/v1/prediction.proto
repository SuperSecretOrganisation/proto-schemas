syntax="proto3";

package proto.prediction.v1;

option go_package = "https://github.com/SuperSecretOrganisation/proto-schemas/gen/go/prediction/v1;predictionpb";

import "google/protobuf/timestamp.proto";

service PredictionService {
    rpc CreatePrediction (CreatePredictionRequest) returns (CreatePredictionResponse);
    rpc GetPrediction (GetPredictionRequest) returns (GetPredictionResponse);
    rpc GetByUserID (GetByUserIDRequest) returns (GetByUserIDResponse);
    rpc UpdatePrediction (UpdatePredictionRequest) returns (UpdatePredictionResponse);
    rpc DeletePrediction (DeletePredictionRequest) returns (DeletePredictionResponse);
    rpc ListPredictions (ListPredictionsRequest) returns (ListPredictionsResponse);
}

message Prediction {
    string uuid = 1;     
    string user_uuid = 2;
    int32 prediction = 3;
    int32 error_range = 4;
    google.protobuf.Timestamp timestamp = 5;
}

message PredictionDTO {
    repeated int32 prediction = 1;
    repeated int32 error_range = 2;
    repeated google.protobuf.Timestamp timestamp = 3; // Optional, defaults to current time if not provided
}

message PredictionFilter {
    google.protobuf.Timestamp start_date = 1; // Start date for filtering
    google.protobuf.Timestamp end_date = 2; // End date for filtering
    int32 page_size = 3; // Number of predictions per page
    int32 page = 4; // Page number for pagination
    bool ascending = 5; // Sort order, true for ascending, false for descending
}

message CreatePredictionRequest {
    string user_uuid = 1;
    int32 prediction = 2;
    int32 error_range = 3;
    google.protobuf.Timestamp timestamp = 4; // Optional, defaults to current time if not provided
}

message CreatePredictionResponse {
    string uuid = 1;
    string user_uuid = 2;
    int32 prediction = 3;
    int32 error_range = 4;
    google.protobuf.Timestamp timestamp = 5; // Timestamp of creation
}

message GetPredictionRequest {
    string uuid = 1;
}

message GetPredictionResponse {
    string uuid = 1;
    string user_uuid = 2;
    int32 prediction = 3;
    int32 error_range = 4;
    google.protobuf.Timestamp timestamp = 5; // Timestamp of the prediction
}

message GetByUserIDRequest {
    string user_uuid = 1; // User UUID to filter predictions
    PredictionFilter filter = 2;
}

message GetByUserIDResponse {
    PredictionDTO predictions = 1; // List of predictions for the user
}

message UpdatePredictionRequest {
    string uuid = 1;
    string user_uuid = 2;
    int32 prediction = 3;
    int32 error_range = 4;
    google.protobuf.Timestamp timestamp = 5; // Optional, defaults to current time if not provided
}

message UpdatePredictionResponse {
    string uuid = 1;
    string user_uuid = 2;
    int32 prediction = 3;
    int32 error_range = 4;
    google.protobuf.Timestamp timestamp = 5; // Timestamp of the update
}

message DeletePredictionRequest {
    string uuid = 1;
}

message DeletePredictionResponse {
    string uuid = 1;
}

message ListPredictionsRequest {
 PredictionFilter filter = 1; // Filter criteria for listing predictions
}

message ListPredictionsResponse {
   PredictionDTO predictions = 1; // List of predictions
}
